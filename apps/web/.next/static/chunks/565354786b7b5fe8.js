(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48296,(e,t,i)=>{function n(e,t=100,i={}){let r,o,a,s,l;if("function"!=typeof e)throw TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw RangeError("`wait` must not be negative.");let{immediate:c}="boolean"==typeof i?{immediate:i}:i;function d(){let t=r,i=o;return r=void 0,o=void 0,l=e.apply(t,i)}function u(){let e=Date.now()-s;e<t&&e>=0?a=setTimeout(u,t-e):(a=void 0,c||(l=d()))}let p=function(...e){if(r&&this!==r&&Object.getPrototypeOf(this)===Object.getPrototypeOf(r))throw Error("Debounced method called with different contexts of the same prototype.");r=this,o=e,s=Date.now();let i=c&&!a;return a||(a=setTimeout(u,t)),i&&(l=d()),l};return Object.defineProperty(p,"isPending",{get:()=>void 0!==a}),p.clear=()=>{a&&(clearTimeout(a),a=void 0)},p.flush=()=>{a&&p.trigger()},p.trigger=()=>{l=d(),p.clear()},p}t.exports.debounce=n,t.exports=n},16455,2718,3376,96974,e=>{"use strict";e.i(91077);var t=e.i(48296),i=e.i(10570);e.s(["useDebounce",0,e=>{let n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{n.current=e},[e]),(0,i.useMemo)((...e)=>(0,t.default)((...e)=>{n.current?.(...e)},1e3),[])}],2718);var n=e.i(38240),r=e.i(98340),o=e.i(13609);let a=o.gql`
  mutation CreateScene(
    $versions: [SceneContentInput]
    $_id: String
  ) {
    createScene(
      input: {
        _id: $_id
        versions: $versions
      }
    ) {
      number
    }
  }
`,s=o.gql`
  mutation UpdateScene(
    $_id: String!
    $number: Int
    $activeVersion: Int
    $lockedVersion: Int
    $newVersion: Boolean
    $newScene: Boolean
    $versions: [SceneContentInput]
  ) {
    createScene(
      input: {
        _id: $_id
        number: $number
        activeVersion: $activeVersion
        lockedVersion: $lockedVersion
        newVersion: $newVersion
        newScene: $newScene
        versions: $versions
      }
    ) {
      number
    }
  }
`;e.s(["CREATE_SCENE",0,a,"UPDATE_SCENE",0,s],3376);let l=o.gql`
  mutation DeleteScene($projectId: String!, $sceneNumber: Int!) {
    deleteScene(projectId: $projectId, sceneNumber: $sceneNumber) {
      id
      scenes {
        number
      }
    }
  }
`;var c=e.i(82125);let d="project-scenes";function u(){let e=(0,r.useQueryClient)(),t=(0,n.useMutation)({mutationFn:async e=>(0,o.request)(c.GRAPHQL_ENDPOINT,s,{_id:e._id,number:e.number,activeVersion:e.activeVersion,lockedVersion:e.lockedVersion??void 0,newVersion:e.newVersion,newScene:!1,versions:e.versions}),onSuccess:(t,i)=>{i._id&&e.invalidateQueries({queryKey:[d,i._id]})}});return{updateSceneMutation:t,deleteSceneMutation:(0,n.useMutation)({mutationFn:async e=>(0,o.request)(c.GRAPHQL_ENDPOINT,l,{projectId:e._id,sceneNumber:e.number}),onSuccess:(t,i)=>{i._id&&e.invalidateQueries({queryKey:[d,i._id]})}}),createSceneMutation:(0,n.useMutation)({mutationFn:async e=>(0,o.request)(c.GRAPHQL_ENDPOINT,a,{_id:e._id,versions:e.versions,number:e.number}),onSuccess:(t,i)=>{i._id&&e.invalidateQueries({queryKey:[d,i._id]})}})}}e.s(["PROJECT_SCENES_QUERY_KEY",0,d,"useProjectSceneMutations",()=>u],96974),e.s([],16455)},40532,e=>{"use strict";var t=e.i(18506),i=e.i(4135),n=e.i(5391),r=e.i(54383),o=e.i(12045),o=o,a=e.i(39134),s=e.i(85131),l=e.i(10570),c=e.i(45050);let d=(0,e.i(33160).create)(e=>({number:1,versions:[],editMode:!1,activeVersion:0,activeStep:"",activeScene:1,sceneContent:{thesis:"",antithesis:"",synthesis:"",synopsis:"",sceneHeading:"",step:"",version:0},createStatement:"",newVersion:!1,versionOptions:[],setVersionOptions:t=>e({versionOptions:t}),handleSave:()=>{},setHandleSave:t=>e({handleSave:t}),setNewVersion:t=>e({newVersion:t}),setCreateStatement:t=>e({createStatement:t}),setSceneContent:t=>e({sceneContent:t}),setActiveScene:t=>e({activeScene:t}),setEditMode:t=>e({editMode:t}),setActiveVersion:t=>e({activeVersion:t}),setActiveStep:t=>e({activeStep:t})}));e.i(16455);var u=e.i(2718),p=e.i(3376),m=e.i(91077),x=e.i(92732),h=e.i(30412),f=e.i(66896);e.i(44332);var v=e.i(69359),g=e.i(43087),b=e.i(98799),y=e.i(71346),S=e.i(67638),j=e.i(41181),C=o,E=e.i(28722),w=e.i(21569),_=e.i(91566),V=e.i(74836);let k=(0,V.default)((0,t.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert"),I=(0,V.default)((0,t.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),N={note:"Note",link:"Link",image:"Image",video:"Video"},T=[{value:"characters",label:"Character"},{value:"outline",label:"Outline"},{value:"treatment",label:"Treatment"},{value:"chat",label:"Chat"}];function M({data:e,onMoveTo:i}){let[n,r]=l.useState(null),o=!!n,a=()=>r(null),s=N[e.type]??e.type;return(0,t.jsxs)(g.default,{variant:"outlined",sx:{height:"100%",minHeight:140,display:"flex",flexDirection:"column",borderRadius:2,borderColor:"divider",backgroundColor:"background.paper"},children:[(0,t.jsxs)(w.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:1.5,pt:1},children:[(0,t.jsxs)(S.default,{variant:"caption",color:"text.secondary",fontWeight:600,children:[s,":"]}),(0,t.jsx)(j.default,{size:"small",onClick:e=>{e.stopPropagation(),r(e.currentTarget)},"aria-label":"Move content","aria-haspopup":"true","aria-expanded":o?"true":void 0,children:(0,t.jsx)(k,{fontSize:"small"})})]}),(0,t.jsxs)(C.default,{anchorEl:n,open:o,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,t.jsx)(S.default,{variant:"caption",sx:{px:2,py:.5,color:"text.secondary"},children:"Move to"}),T.map(e=>(0,t.jsx)(E.default,{onClick:()=>{var t;return t=e.value,void(i?.(t),a())},children:e.label},e.value))]}),(0,t.jsxs)(b.default,{sx:{flex:1,pt:0,pb:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:["note"===e.type&&(0,t.jsx)(S.default,{variant:"body2",color:"text.primary",sx:{overflow:"auto",flex:1},children:e.text||"—"}),"link"===e.type&&(0,t.jsxs)(w.default,{sx:{overflow:"auto",flex:1},children:[(0,t.jsx)(_.default,{href:e.url,target:"_blank",rel:"noopener noreferrer",variant:"body2",underline:"hover",sx:{wordBreak:"break-all"},children:e.label||e.url||"—"}),e.label&&e.url&&e.url!==e.label&&(0,t.jsx)(S.default,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:.5},children:e.url})]}),"image"===e.type&&(0,t.jsxs)(w.default,{sx:{flex:1,minHeight:80,display:"flex",flexDirection:"column"},children:[e.src?(0,t.jsx)(y.default,{component:"img",image:e.src,alt:e.caption||"Image",sx:{objectFit:"cover",borderRadius:1,maxHeight:120,flex:1}}):(0,t.jsx)(w.default,{sx:{flex:1,bgcolor:"action.hover",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:80},children:(0,t.jsx)(S.default,{variant:"caption",color:"text.secondary",children:"No image"})}),e.caption&&(0,t.jsx)(S.default,{variant:"caption",color:"text.secondary",sx:{mt:.5},children:e.caption})]}),"video"===e.type&&(0,t.jsxs)(w.default,{sx:{flex:1,minHeight:80,display:"flex",flexDirection:"column"},children:[e.src?(0,t.jsxs)(w.default,{sx:{position:"relative",borderRadius:1,overflow:"hidden",bgcolor:"action.hover",flex:1,minHeight:80},children:[(0,t.jsx)(y.default,{component:"img",image:e.src,alt:e.caption||"Video",sx:{objectFit:"cover",width:"100%",maxHeight:120}}),(0,t.jsx)(w.default,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"rgba(0,0,0,0.3)"},children:(0,t.jsx)(I,{sx:{fontSize:48,color:"common.white"}})})]}):(0,t.jsx)(w.default,{sx:{flex:1,bgcolor:"action.hover",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:80},children:(0,t.jsx)(I,{sx:{fontSize:40,color:"text.disabled"}})}),e.caption&&(0,t.jsx)(S.default,{variant:"caption",color:"text.secondary",sx:{mt:.5},children:e.caption})]})]})]})}let A=[{id:"1",type:"note",text:"A retired detective must find a missing android who holds the key to his own past."},{id:"2",type:"note",text:"A lone pilot discovers a signal from a colony thought lost decades ago."},{id:"3",type:"link",url:"https://example.com/reference-material",label:"Reference: world-building doc"},{id:"4",type:"link",url:"https://example.com/visual-mood",label:"Visual mood board"},{id:"5",type:"image",src:"/logo_symbol.png",caption:"Mood: neon city"},{id:"6",type:"image",src:"/logo_4.png",caption:"Character concept"},{id:"7",type:"video",src:"/logo_symbol.png",caption:"Pitch reel placeholder"}];function $(){d(e=>e.setEditMode),d(e=>e.activeStep),d(e=>e.setActiveStep),d(e=>e.setActiveScene);let e=d(e=>e.activeVersion);d(e=>e.setActiveVersion);let g=d(e=>e.setNewVersion),b=d(e=>e.setHandleSave),y=d(e=>e.createStatement),S=d(e=>e.setCreateStatement);d(e=>e.versionOptions);let j=d(e=>e.setVersionOptions),[C,E]=(0,l.useState)(),[w,_]=(0,l.useState)(),[V,k]=(0,l.useState)(!0),[I,N]=(0,l.useState)(!0),[T,$]=(0,l.useState)([]),[P,R]=(0,l.useState)([]),[O,D]=(0,l.useState)(0),[H,q]=(0,l.useState)(0),[z,Q]=(0,l.useState)(""),[B,G]=(0,l.useState)(0),[U,K]=(0,l.useState)(A),[F,L]=(0,l.useState)(null);(0,f.useParams)().id;let W={createStatement:p.UPDATE_SCENE,createVariables:w,invalidateQueriesArray:["projects"],stateResetters:{setCreateStatement:S,setCreateVariables:_,setVersionOptions:j,setNewVersion:g}},Y={createStatement:p.CREATE_SCENE,createVariables:w,invalidateQueriesArray:["projects"],stateResetters:{setCreateStatement:S,setCreateVariables:_}},J=(0,x.createMutation)(Y);(0,m.useCreateMutation)(y,w,J,h.GqlStatements.CREATE_SCENE);let X=(0,x.createMutation)(W);(0,m.useCreateMutation)(y,C,X,h.GqlStatements.UPDATE_SCENE);let Z=(0,u.useDebounce)((t,i,n,r,o,a,s,l)=>{i&&(S(p.CREATE_SCENE),_({act:B,projectId:n,newVersion:t,number:r,activeVersion:e,newScene:i,versions:[{act:B,[s]:l,step:a}]}))});(0,l.useEffect)(()=>{b(Z)},[Z]);let ee=e=>{K(t=>[...t,function(e){let t=`new-${Date.now()}`;switch(e){case"note":default:return{id:t,type:"note",text:"New note…"};case"link":return{id:t,type:"link",url:"",label:"New link"};case"image":return{id:t,type:"image",caption:"New image"};case"video":return{id:t,type:"video",caption:"New video"}}}(e)]),L(null)},et=e=>{};return(0,t.jsxs)(r.Container,{maxWidth:!1,disableGutters:!0,sx:{display:"flex",flexDirection:"column",flex:1,padding:2,height:"100%",width:"100%"},children:[(0,t.jsx)(v.ProjectHeader,{}),(0,t.jsxs)(r.Container,{maxWidth:!1,disableGutters:!0,sx:{flex:1,width:"100%",paddingTop:2},children:[(0,t.jsxs)(i.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1,mb:2},children:[(0,t.jsx)(s.Typography,{variant:"h6",fontWeight:600,children:"Scratch Pad Ideas"}),(0,t.jsx)(n.Button,{variant:"contained",color:"primary",size:"small",startIcon:(0,t.jsx)(c.default,{}),onClick:e=>L(e.currentTarget),"aria-controls":F?"add-scratch-card-menu":void 0,"aria-haspopup":"true","aria-expanded":F?"true":void 0,children:"Add card"})]}),(0,t.jsxs)(o.default,{id:"add-scratch-card-menu",anchorEl:F,open:!!F,onClose:()=>L(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,t.jsx)(a.MenuItem,{onClick:()=>ee("note"),children:"Note"}),(0,t.jsx)(a.MenuItem,{onClick:()=>ee("link"),children:"Link"}),(0,t.jsx)(a.MenuItem,{onClick:()=>ee("image"),children:"Image"}),(0,t.jsx)(a.MenuItem,{onClick:()=>ee("video"),children:"Video"})]}),(0,t.jsx)(i.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:2},children:U.map(e=>(0,t.jsx)(M,{data:e,onMoveTo:et},e.id))})]})]})}e.s(["default",()=>$],40532)}]);