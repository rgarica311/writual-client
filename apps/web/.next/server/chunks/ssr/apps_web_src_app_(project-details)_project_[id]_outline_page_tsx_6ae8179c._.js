module.exports=[87746,a=>{"use strict";var b=a.i(65886),c=a.i(2320),d=a.i(45388),e=a.i(35969),f=a.i(8191),g=a.i(16164),h=a.i(81310),i=a.i(52180),j=a.i(31316);a.i(25854);var k=a.i(26379),l=a.i(23304),m=a.i(50584);a.i(14874);var n=a.i(51344),o=a.i(49929),p=a.i(39337),q=a.i(99220),r=a.i(63624),s=a.i(49499),t=a.i(61857),u=a.i(35630);let v=(0,r.styled)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(a,b)=>{let{ownerState:c}=a;return[b.root,c.absolute&&b.absolute,b[c.variant],c.light&&b.light,"vertical"===c.orientation&&b.vertical,c.flexItem&&b.flexItem,c.children&&b.withChildren,c.children&&"vertical"===c.orientation&&b.withChildrenVertical,"right"===c.textAlign&&"vertical"!==c.orientation&&b.textAlignRight,"left"===c.textAlign&&"vertical"!==c.orientation&&b.textAlignLeft]}})((0,s.default)(({theme:a})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(a.vars||a).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:a.alpha((a.vars||a).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:a.spacing(2),marginRight:a.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:a.spacing(1),marginBottom:a.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:a})=>!!a.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:a})=>a.children&&"vertical"!==a.orientation,style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(a.vars||a).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:a})=>"vertical"===a.orientation&&a.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(a.vars||a).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:a})=>"right"===a.textAlign&&"vertical"!==a.orientation,style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:a})=>"left"===a.textAlign&&"vertical"!==a.orientation,style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),w=(0,r.styled)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(a,b)=>{let{ownerState:c}=a;return[b.wrapper,"vertical"===c.orientation&&b.wrapperVertical]}})((0,s.default)(({theme:a})=>({display:"inline-block",paddingLeft:`calc(${a.spacing(1)} * 1.2)`,paddingRight:`calc(${a.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${a.spacing(1)} * 1.2)`,paddingBottom:`calc(${a.spacing(1)} * 1.2)`}}]}))),x=c.forwardRef(function(a,c){let d=(0,t.useDefaultProps)({props:a,name:"MuiDivider"}),{absolute:e=!1,children:f,className:g,orientation:h="horizontal",component:i=f||"vertical"===h?"div":"hr",flexItem:j=!1,light:k=!1,role:l="hr"!==i?"separator":void 0,textAlign:m="center",variant:n="fullWidth",...o}=d,r={...d,absolute:e,component:i,flexItem:j,light:k,orientation:h,role:l,textAlign:m,variant:n},s=(a=>{let{absolute:b,children:c,classes:d,flexItem:e,light:f,orientation:g,textAlign:h,variant:i}=a;return(0,q.default)({root:["root",b&&"absolute",i,f&&"light","vertical"===g&&"vertical",e&&"flexItem",c&&"withChildren",c&&"vertical"===g&&"withChildrenVertical","right"===h&&"vertical"!==g&&"textAlignRight","left"===h&&"vertical"!==g&&"textAlignLeft"],wrapper:["wrapper","vertical"===g&&"wrapperVertical"]},u.getDividerUtilityClass,d)})(r);return(0,b.jsx)(v,{as:i,className:(0,p.default)(s.root,g),role:l,ref:c,ownerState:r,"aria-orientation":"separator"===l&&("hr"!==i||"vertical"===h)?h:void 0,...o,children:f?(0,b.jsx)(w,{className:s.wrapper,ownerState:r,children:f}):null})});x&&(x.muiSkipListHighlight=!0);var y=a.i(65279),z=a.i(26805),A=a.i(42769),B=a.i(48840),C=a.i(29907),D=a.i(40347),E=a.i(11440);let F=(0,E.default)((0,b.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen"),G=(0,E.default)((0,b.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock");var H=a.i(45106),I=a.i(79374);a.i(38912);var J=a.i(11883);let K={overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical"},L=({number:a,newScene:e=!1,versions:f,activeVersion:h,lockedVersion:i,act:j,projectId:k,step:p,onDelete:q})=>{let r=Math.max(1,Number(h??1)),[s,t]=(0,c.useState)(r),[u,v]=(0,c.useState)(!1),[w,E]=(0,c.useState)({thesis:"",antithesis:"",synthesis:"",synopsis:"",sceneHeading:""}),L=(0,c.useRef)(null),M=(0,c.useRef)({}),N=(0,c.useRef)({version:r,newVersion:!1}),O=(0,c.useRef)(f??[]),{updateSceneMutation:P,deleteSceneMutation:Q}=(0,J.useProjectSceneMutations)(),R=(0,D.useTheme)(),[S,T]=(0,c.useState)(null!=i);(0,c.useEffect)(()=>{O.current=Array.isArray(f)?f:[]},[f]),(0,c.useEffect)(()=>{t(Math.max(1,Number(h??1)))},[h]),(0,c.useEffect)(()=>{T(null!=i)},[i]),(0,c.useEffect)(()=>{if(u)return void E({thesis:"",antithesis:"",synthesis:"",synopsis:"",sceneHeading:""});let a=Math.max(0,s-1),b=O.current[a]??O.current[0];E({version:b?.version??s,thesis:b?.thesis??"",antithesis:b?.antithesis??"",synthesis:b?.synthesis??"",synopsis:b?.synopsis??"",sceneHeading:b?.sceneHeading??"",step:b?.step??p??"",act:b?.act??j??void 0})},[s,u,p,j,f]),(0,c.useEffect)(()=>{M.current=w},[w]),(0,c.useEffect)(()=>()=>{L.current&&clearTimeout(L.current)},[]);let U=b=>c=>{let d=c.target.value;E(a=>({...a,[b]:d})),S||!k||(N.current={version:s||1,newVersion:u},L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{L.current=null;let b=M.current,{version:c,newVersion:d}=N.current,e=Math.max(0,c-1),f={...O.current[e]??{},thesis:b.thesis??"",antithesis:b.antithesis??"",synthesis:b.synthesis??"",sceneHeading:b.sceneHeading??"",synopsis:b.synopsis??"",step:b.step??"",act:b.act??void 0,version:c};P.mutate({_id:k,number:a,activeVersion:c,newVersion:d,versions:[f]},{onSuccess:()=>{d&&v(!1)}})},2e3))},V=(Array.isArray(f)?f.length:0)+ +!!u,W=(0,c.useMemo)(()=>Array.from({length:Math.max(1,V)},(a,b)=>b+1),[V]),X=String(s);return(0,b.jsxs)(l.default,{sx:{...n.sceneCardStyle.card,backgroundColor:R.palette.background.paper,display:"flex",flexDirection:"column"},children:[(0,b.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1,px:2,py:1.5},children:[(0,b.jsx)(d.Box,{sx:{display:"flex",alignItems:"center",gap:1,minWidth:220,flex:1},children:S?(0,b.jsx)(g.Typography,{variant:"subtitle1",fontWeight:700,component:"span",sx:K,children:w.sceneHeading?.trim()||"Untitled scene"}):(0,b.jsx)(C.TextField,{size:"small",value:w.sceneHeading??"",onChange:U("sceneHeading"),placeholder:"Scene heading",variant:"outlined",sx:{minWidth:200,flex:1,"& .MuiInputBase-input":{py:.5}}})}),(0,b.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,b.jsx)(o.Chip,{label:`#${a}`,size:"small",sx:{backgroundColor:R.palette.grey[600],color:R.palette.common.white,fontWeight:600}}),(0,b.jsx)(o.Chip,{label:`v${s}`,size:"small",sx:{backgroundColor:R.palette.grey[300],color:R.palette.text.primary,fontWeight:600}})]})]}),(0,b.jsx)(x,{}),(0,b.jsx)(m.default,{sx:{flex:"0 1 auto",height:175,overflowY:"auto",p:1,px:2,"&:last-child":{pb:1.5}},children:(0,b.jsxs)(d.Box,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,b.jsxs)(d.Box,{children:[(0,b.jsx)(g.Typography,{component:"span",fontWeight:700,sx:{display:"block",mb:.25},variant:"body2",children:"Thesis:"}),S?(0,b.jsx)(g.Typography,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:w.thesis?.trim()||"—"}):(0,b.jsx)(C.TextField,{fullWidth:!0,size:"small",multiline:!0,minRows:2,maxRows:4,value:w.thesis??"",onChange:U("thesis"),placeholder:"—",variant:"outlined",sx:{"& .MuiInputBase-input":{py:.5}}})]}),(0,b.jsxs)(d.Box,{children:[(0,b.jsx)(g.Typography,{component:"span",fontWeight:700,sx:{display:"block",mb:.25},variant:"body2",children:"Antithesis:"}),S?(0,b.jsx)(g.Typography,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:w.antithesis?.trim()||"—"}):(0,b.jsx)(C.TextField,{fullWidth:!0,size:"small",multiline:!0,minRows:2,maxRows:4,value:w.antithesis??"",onChange:U("antithesis"),placeholder:"—",variant:"outlined",sx:{"& .MuiInputBase-input":{py:.5}}})]}),(0,b.jsxs)(d.Box,{children:[(0,b.jsx)(g.Typography,{component:"span",fontWeight:700,sx:{display:"block",mb:.25},variant:"body2",children:"Synthesis:"}),S?(0,b.jsx)(g.Typography,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:w.synthesis?.trim()||"—"}):(0,b.jsx)(C.TextField,{fullWidth:!0,size:"small",multiline:!0,minRows:2,maxRows:4,value:w.synthesis??"",onChange:U("synthesis"),placeholder:"—",variant:"outlined",sx:{"& .MuiInputBase-input":{py:.5}}})]})]})}),(0,b.jsx)(x,{}),(0,b.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,minHeight:30,px:2,py:1.5,flexShrink:0},children:[(0,b.jsx)(z.IconButton,{size:"small",onClick:b=>{if(b.preventDefault(),b.stopPropagation(),!k)return;let c=S?null:s;T(!S);let d=Math.max(0,s-1),e=O.current[d]??{};P.mutate({_id:k,number:a,activeVersion:s,lockedVersion:c??void 0,newVersion:!1,versions:[e]})},sx:{backgroundColor:S?R.palette.primary.main:R.palette.grey[200],color:S?R.palette.primary.contrastText??R.palette.common.white:R.palette.grey[700],"&:hover":{backgroundColor:S?R.palette.primary.dark:R.palette.grey[300]}},"aria-label":S?"Unlock scene":"Lock scene",children:S?(0,b.jsx)(G,{fontSize:"small"}):(0,b.jsx)(F,{fontSize:"small"})}),(0,b.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",gap:1,flex:1,justifyContent:"center"},children:[(0,b.jsx)(y.FormControl,{size:"small",sx:{minWidth:140},children:(0,b.jsx)(B.Select,{value:X,onChange:b=>{if(S)return;let c=parseInt(b.target.value,10);if(Number.isFinite(c)&&!(c<1)&&(v(!1),t(c),k)){let b=Math.max(0,c-1),d=O.current[b]??{};P.mutate({_id:k,number:a,activeVersion:c,newVersion:!1,versions:[d]})}},disabled:S,displayEmpty:!0,sx:{backgroundColor:R.palette.grey[100],borderRadius:1,fontSize:"0.875rem","& .MuiSelect-select":{py:.75}},renderValue:a=>`v${a} (Active)`,children:W.map(a=>(0,b.jsxs)(A.MenuItem,{value:String(a),children:["v",a,u&&a===W.length?" (New)":""]},a))})}),(0,b.jsx)(z.IconButton,{size:"small",onClick:b=>{if(b.preventDefault(),b.stopPropagation(),S||!k)return;L.current&&(clearTimeout(L.current),L.current=null);let c=(Array.isArray(f)?f.length:0)+1;v(!0),t(c),P.mutate({_id:k,number:a,activeVersion:c,newVersion:!0,versions:[{version:c,sceneHeading:"",thesis:"",antithesis:"",synthesis:"",synopsis:"",step:p??"",act:j??void 0}]},{onSuccess:()=>{v(!1)}})},disabled:S,"aria-label":"Add new version",sx:{backgroundColor:R.palette.primary.light,color:R.palette.primary.contrastText??R.palette.common.white,"&:hover":{backgroundColor:R.palette.primary.main}},children:(0,b.jsx)(I.default,{fontSize:"small"})})]}),(0,b.jsx)(z.IconButton,{size:"small",onClick:()=>{k&&Q.mutate({_id:k,number:a},{onSuccess:()=>q?.()})},sx:{backgroundColor:R.palette.error.light,color:R.palette.error.contrastText??R.palette.common.white,"&:hover":{backgroundColor:R.palette.error.main}},"aria-label":"Delete scene",children:(0,b.jsx)(H.default,{fontSize:"small"})})]})]})};var M=a.i(30311);let N=a.i(24460).GRAPHQL_ENDPOINT,O={version:1,sceneHeading:"",thesis:"",antithesis:"",synthesis:"",synopsis:"",act:1};function P(){let a=(0,h.useParams)(),l=a?.id,{createSceneMutation:m}=(0,J.useProjectSceneMutations)(),n=c.useMemo(()=>({input:{user:"rory.garcia1@gmail.com",_id:l}}),[l]),{data:o}=(0,i.useQuery)({queryKey:[J.PROJECT_SCENES_QUERY_KEY,l],queryFn:()=>(0,j.request)(N,M.PROJECT_SCENES_QUERY,n),enabled:!!l}),p=o?.getProjectData?.[0]?.scenes??[];return(0,b.jsxs)(f.Container,{maxWidth:!1,disableGutters:!0,sx:{border:"1px solid green",display:"flex",flexDirection:"column",flex:1,padding:2,height:"100%",width:"100%"},children:[(0,b.jsx)(k.ProjectHeader,{}),(0,b.jsxs)(f.Container,{maxWidth:!1,disableGutters:!0,sx:{minHeight:"500px",width:"100%",paddingTop:2},children:[(0,b.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:1,mb:2},children:[(0,b.jsx)(g.Typography,{variant:"h6",fontWeight:600,children:"Outline"}),(0,b.jsx)(e.Button,{variant:"contained",color:"primary",size:"small",startIcon:(0,b.jsx)(I.default,{}),onClick:()=>{l&&m.mutate({_id:l,number:p.length+1,versions:[{...O}]})},disabled:m.isPending,children:"New scene"})]}),(0,b.jsx)(d.Box,{sx:{height:"calc(100% - 45px)",display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"scroll",gap:2},children:p.map((a,c)=>{let d=a.activeVersion??1,e=Math.max(0,d-1),f=a.versions?.[e];return(0,b.jsx)(L,{number:a.number,newScene:!1,versions:a.versions??[],activeVersion:d,lockedVersion:a.lockedVersion??null,projectId:a.projectId??l,step:f?.step??""},a.number??c)})})]})]})}a.s(["default",()=>P],87746)}];

//# sourceMappingURL=apps_web_src_app_%28project-details%29_project_%5Bid%5D_outline_page_tsx_6ae8179c._.js.map